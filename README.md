# Viewstalker
A tool for identifying and exploiting vulnerable Viewstate implementations in ASP.NET 


### Background

Viewstates are widely used in ASP.NET applications. Viewstates are serialized objects containing arbitrary data for use in a variety of functions in these applications. Deserialization on the backend occurs after the integrity of the viewstate has been verified. Both deserialization and serialization are handled by [System.Web.UI.LosFormatter](https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.losformatter?view=netframework-4.8), which does not perform deserialization in a secure manner. As a result, attackers can achieve remote code execution on a vulnerable target by supplying a malicious gadget chain, like those generated by [ysoserial.net](https://github.com/pwntester/ysoserial.net).

Despite the relative ease of exploitation, this vulnerability persists in the wild, much to my dismay. To address this, I am providing the community with ViewStalker, which can be used to identify and exploit vulnerable applications. 

```
usage: viewStalker [-h|--help] [-l|--hosts <file>] [-M|--mac <file>]
                   [-a|--address "<value>"] [-t|--test "<value>"]
                   [-v|--viewstate "<value>"] [-m|--modifier "<value>"]
                   [-k|--key "<value>"] [-s|--algo "<value>"]

                   A tool for identifying vulnerable ASP.NET viewstates

Arguments:

  -h  --help       Print help information
  -l  --hosts      Path to file with list of hosts to check, one per line
  -M  --mac        machine keys file from blacklist3r
  -a  --address    Single host to check
  -t  --test       test flag. Only acceptable value at present is "viewstate"
  -v  --viewstate  b64 encoded viewstate
  -m  --modifier   modifer
  -k  --key        validation key
  -s  --algo       algorithm for validation

```





### TODO:
- [x] initial target handling and parsing
- [x] recreate blacklist3r functionality for bruting keys
- [x] Multi-host scanning
- [ ] automatic payload generation and exploitation
- [ ] Support for JSF viewstates
